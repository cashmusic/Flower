var FlowerLinkExternal=new Class({initialize:function(){this.name="linkexternal";this.version=1.1},attachToElement:function(a){a.removeEvents("click");a.addEvent("click",function(c){var b=a.getProperty("href");c.stop();window.open(b,"flower_"+$random(10000,99999))})}});var FlowerLinkPopup=new Class({initialize:function(){this.name="linkpopup";this.version=1;this.openoptions="width=480,height=320,scrollbars=yes,resizable=yes,location=no,directories=no,status=no"},attachToElement:function(c){var b=c.getProperty("rev"),a=this.openoptions;c.removeEvents("click");if(b){if(b.contains("popup:")){a=b.substring(6,b.length)}}c.addEvent("click",function(f){var d=c.getProperty("href");f.stop();window.open(d,"flower_external"+$random(10000,99999),a)}.bind(this))}});var FlowerLinkInside=new Class({initialize:function(){this.name="linkinside";this.version=1.2},attachToElement:function(a){a.removeEvents("click");a.addEvent("click",function(i){i.stop();var h="",f="",d=a.getProperty("href"),g=a.getProperty("rev"),j=false,c,b;if(d.contains("?")){h=d.split("?")[1];d=d.split("?")[0]}if(g){if(g.contains("linkinside:")){$A(g.substring(11,g.length).split(",")).each(function(e){c=e.split("=");if(c[0]=="target"){f=c[1]
}})}if(f=="parent"){j=true}else{if(!f){f=document.id(f)}}}if(!f||f=="parent"){f=document.id(a.getParent());if(!j){while(f.getTag()!="div"){f=f.getParent()}}}b=new Request.HTML({url:d,update:f,data:h,onSuccess:function(){if(this.flowerCore){this.flowerCore.htmlContentChanged(f)}}.bind(this)}).get()}.bind(this))}});var FlowerDrawer=new Class({Implements:Options,options:{closeOnAttach:false},initialize:function(a){this.name="drawer";this.version=1;this.setOptions(a)},closedrawer:function(a){a.setStyle("height",1);a.setStyle("display","none");a.store("FlowerDrawer_state",1)},toggle:function(a,c){var b;if(a.retrieve("FlowerDrawer_state")==11){b=a.getScrollSize().y;a.store("FlowerDrawer_state",10);a.setStyle("height",b);a.get("tween",{property:"height",duration:250,link:"cancel"}).start(b,1).chain(function(){a.setStyle("display","none");a.store("FlowerDrawer_state",1);var d=a.retrieve("FlowerDrawer_altText");if(d){a.store("FlowerDrawer_altText",c.get("html"));c.set("html",d)}}.bind(this))}else{if(a.retrieve("FlowerDrawer_state")==1){a.store("FlowerDrawer_state",10);a.setStyle("display","block");b=a.getScrollSize().y;a.get("tween",{property:"height",duration:250,link:"cancel"}).start(1,b).chain(function(){a.setStyle("height","auto");
a.store("FlowerDrawer_state",11);var d=a.retrieve("FlowerDrawer_altText");if(d){a.store("FlowerDrawer_altText",c.get("html"));c.set("html",d)}}.bind(this))}}},attachToElement:function(d){var c=d.getProperty("rev"),b=false,g=false,e=false,a;if(c){if(c.contains("drawer:")){$A(c.substring(7,c.length).split(",")).each(function(i){var h=i.split("=");switch(h[0]){case"target":if(h[1]){b=document.id(h[1])}break;case"hideLink":if(h[1]){g=h[1]}break;case"altLinkText":if(h[1]){e=h[1]}break}})}if(b){var f=b.getStyle("position");if(f!="absolute"&&f!="relative"&&f!="fixed"){b.setStyles({position:"relative",overflow:"hidden"})}else{b.setStyle("overflow","hidden")}if(e){b.store("FlowerDrawer_altText",e)}d.removeEvents("click");d.setStyle("cursor","pointer");if(b.currentStyle){a=b.currentStyle.display}else{a=document.defaultView.getComputedStyle(b,null);if(a!==null){a=a.getPropertyValue("display")}else{a="none"}}if(a=="none"){this.closedrawer(b)}else{b.store("FlowerDrawer_state",11);if(this.options.closeOnAttach){this.toggle(b,d)}}d.addEvent("click",function(i){var h;i.stop();this.toggle(b,d);if(g){d.setStyle("display","none")}}.bind(this))}else{if(this.debugMsg){this.debugMsg(1,"invalid target specified")
}}}else{if(this.debugMsg){this.debugMsg(1,'a target must be specified (rev="drawer:target=elementId") with a toggle anchor')}}}});window.addEvent("domready",function(){if(typeof(flowerUID)=="object"){flowerUID.registerModule(FlowerLinkExternal,"linkexternal");flowerUID.registerModule(FlowerLinkPopup,"linkpopup");flowerUID.registerModule(FlowerLinkInside,"linkinside");flowerUID.registerModule(FlowerDrawer,"drawer")}else{var c=new FlowerLinkExternal(),d=new FlowerLinkPopup(),a=new FlowerLinkInside(),b=new FlowerLinkInside();$$("a.external").each(function(e){c.attachToElement(e)});$$("a.popup").each(function(e){d.attachToElement(e)});$$("a.flower_linkinside").each(function(e){a.attachToElement(e)});$$("a.flower_drawertoggle").each(function(e){b.attachToElement(e)})}});
var FlowerOverlay=new Class({initialize:function(){this.name="overlay";this.version=1.1;this.donotdebugoptions=true},options:{fadelevel:0.85,overlaycolor:"#000000",contentspcbg:"#000000",linkcolor:"#999999",linkovercolor:"#ffffff",textcolor:"#cccccc",borderwidth:5,boxwidth:640,boxheight:360,zindex:1234},createDomElements:function(){this.overlaySpc=new Element("div",{"class":"flower_overlay_container",styles:{position:(Browser.Engine.trident4)?"absolute":"fixed",top:"0px",left:"0px",width:"100%",height:"100%",background:"transparent","z-index":this.options.zindex,display:"none"}}).inject(document.body);this.overlay=new Element("div",{"class":"flower_overlay",styles:{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",visibility:"hidden",background:this.options.overlaycolor,"z-index":"1"}}).inject(this.overlaySpc);this.overlayContentSpc=new Element("div",{"class":"flower_overlay_contentcontainer",styles:{position:"absolute",top:"50%",left:"50%","margin-top":(0-(this.renderboxheight/2)-this.options.borderwidth)+"px","margin-left":(0-(this.renderboxwidth/2)-this.options.borderwidth)+"px",width:this.renderboxwidth+"px",height:"1px","background-color":this.options.contentspcbg,border:this.options.borderwidth+"px solid "+this.options.contentspcbg,overflow:"hidden",visibility:"hidden","z-index":"10"}}).inject(this.overlaySpc);
this.overlayCaptionSpc=new Element("div",{"class":"flower_overlay_captioncontainer",styles:{position:"absolute",top:"50%",right:"50%","margin-top":((this.renderboxheight/2)+this.options.borderwidth)+"px","margin-right":0-(this.renderboxwidth/2)+"px","background-color":"transparent",width:this.renderboxwidth+"px","text-align":"right",visibility:"hidden","z-index":"20"}}).inject(this.overlaySpc);this.overlayCaption=new Element("p",{"class":"flower_overlay_caption",styles:{color:this.options.textcolor,display:"none",margin:"5px 0 0 0",padding:"0","z-index":"10"}}).inject(this.overlayCaptionSpc);this.addControlElements();this.addOverlayEffects();this.addOverlayEvents();if(Browser.Engine.trident4){this.fixIe6Fixed();window.addEvent("scroll",this.fixIe6Fixed.bind(this))}},addControlElements:function(){this.overlayControlSpc=new Element("div",{"class":"flower_overlay_controls",styles:{margin:"5px 0 0 0","white-space":"nowrap","z-index":"15"}}).inject(this.overlayCaptionSpc);this.overlayCloseLink=new Element("a",{"class":"flower_overlay_controllink",styles:{color:this.options.linkcolor,margin:"0",cursor:"pointer"},html:"close",events:{mouseover:function(a){this.overlayCloseLink.setStyle("color",this.options.linkovercolor)
}.bind(this),mouseout:function(a){this.overlayCloseLink.setStyle("color",this.options.linkcolor)}.bind(this),click:function(a){this.hideOverlay();a.stop()}.bind(this)}}).inject(this.overlayControlSpc)},addOverlayEvents:function(){this.overlay.addEvent("click",this.hideOverlay.bind(this))},addOverlayEffects:function(){this.fxOverlay=new Fx.Tween(this.overlay,{property:"opacity",fps:33,duration:250});this.fxOpenContentSpc=new Fx.Tween(this.overlayContentSpc,{property:"height",fps:33,duration:500})},addKeyEvents:function(){document.addEvent("keydown",function(a){if(this.state==11&&a.key=="esc"){this.hideOverlay()}}.bind(this))},showOverlay:function(){this.overlayContentSpc.setStyles({width:this.renderboxwidth+"px","margin-left":(0-(this.renderboxwidth/2)-this.options.borderwidth)+"px","margin-top":(0-(this.renderboxheight/2)-this.options.borderwidth)+"px"});this.overlaySpc.setStyle("display","block");this.fxOverlay.start(0,this.options.fadelevel).chain(function(){this.overlayContentSpc.setStyle("visibility","visible");this.fxOpenContentSpc.start(1,this.renderboxheight).chain(function(){this.showContent()}.bind(this))}.bind(this))},positionCaption:function(){if(this.caption){this.overlayCaption.set("html",this.caption);
this.overlayCaption.setStyle("display","block")}else{this.overlayCaption.setStyle("display","none")}this.overlayCaptionSpc.setStyles({width:this.renderboxwidth+"px","margin-top":((this.renderboxheight/2)+this.options.borderwidth)+"px","margin-right":0-(this.renderboxwidth/2)+"px",visibility:"visible"})},hideOverlay:function(){this.overlayContentSpc.setStyles({visibility:"hidden",height:"1px"});this.overlayCaptionSpc.setStyle("visibility","hidden");this.fxOverlay.start(this.options.fadelevel,0).chain(function(){this.overlay.setStyle("visibility","hidden");if(!this.caption){this.caption="";this.overlayCaption.set("html","")}this.overlayCaption.setStyle("display","none");this.overlaySpc.setStyle("display","none")}.bind(this))},fixIe6Fixed:function(){this.overlaySpc.setStyles({top:window.getScroll().y+"px",left:window.getScroll().x+"px",width:"100%",height:"100%"})}});window.addEvent("domready",function(){if(typeof(flowerUID)=="object"){flowerUID.registerModule(FlowerOverlay,"overlay")}});